#
#	Comments file
#

1	{start} **__Dungeon Campaign by Robert Clardy. Reverse engineered by Paul Robson 2017
5   {delaytwosec} * Delay two seconds
6   {delaysec} * Delay a second
7   {delayhalfsec} * Delay half a second
10  {drawSquare} *Draw Square, current colour, current position.
11 	{convertPosition} * Convert xPos,yPos to position in maze, contents and screen position
12  {findEmptySlot} * Find an empty slot (upper digit is zero)
13  {openSquareRoom} * Find a square which is the upper left of open four
14  {} erase on the display
15  {} on first two levels, make the first one a gas area (9x)
16  {openSquareWalls} remove walls to make a square. move to one of the 4 squares randomly.
18  {readKeyboardGasCheck} *_Read Keyboard Checking for Gas
20  {noKey}No check for gas if there is none and not the serpent boss, move serpent ? back if count not mod =0
25  {} dec gas count , loop back if not time out or counter not mod 0
30  {} one of the party dies, back to prompt.
40  {moveSerpent} *Move the serpent
500 {moveSpectre} *Move the Spectre
769 {initialise} *_Initialise Game
770 {} display title page (poke 50,63 is inverse poke 50,127 is normal)
780 {} *install machine code to play beeps etc.

801 {createMaze} *_Create the maze
802 {} *dimension 13x13x4 maze and fill with '3' (wall right and below)
1001 {} *Do for each level.
1003 {} Fill whole screen with the correct background colour (visuals only)
1030 {} *Find the start position
1035 {nextClear} * Clear the next square in the maze. When done set all non-open walls to -63

1040 {clearOneSquare} * Clear a single square in the maze.
1050 {} figure out which way we can go e.g. is there a wall there ?
1080 {} if there is a used square near by, find a new starting point
1110 {tryMoveDirection} dispatch to movers
1130 {} try to move right
1140 {} try to move down
1150 {} try to move left
1160 {} try to move up
1170 {newStartPoint} * Find a new start point as we can't go any further.
1200 {doRooms} * Create 5 square rooms. 3-5 have treasure in them (7x)
1205 {} * Put pits (2x) necro/ptero (3x) monster/w treasure (8x) stairs (5x) monster no treasure (4x)
1212 {} Pits, check there is something to fall through to.
1215 {} No stairs on L1
1220 {} One treasureless monster.
1260 {} * Special stuff Level 4. Find position on edge. Find start position
1265 {} Draw Frame
1290 {} Get monster Names
1500 {prompt} *Prompt for command, check for gas
1501 {getCommand} *Get command, update bosses if not invisible.
1520 {executeCommand} Execute Command
1560 {displayCommands} Display command list

2000 {moveRight} * Move Right
2020 {moveCode} *_General Move Code (validated in maze). Erase if dwarf dead, animate movement, do actual move.
2100 {} Reconvert position. , if not in gas 
2102 {} * Make Gas area visible Look in [-1,-1] [0,-1] [-1,0] [0,0] for gas
2105 {} Draw gas cells
2110 {} Redraw player
2120 {completeMove} *Show walls, update dragon count, if jumping do it again w/o checks
2130 {checkMoveResult} get new maze contents, handle stairs (5) or stairs on next level (+169)
2145 {} if elf dead then no warning.
2150 {} check in four directions for pit trap/necromancer/pterodactyl
2160 {reportDanger} report danger near
2170 {exitMove} * Check what you hit : monster (4 or 8) 2 (pit) 3 (necro/ptero)
2500 {moveLeft} * Move Left
3000 {moveUp} * Move Up
3500 {moveDown} * Move Down
3700 {jump} *Jump Hazard
3740 {displayStatus} *Display Status
3755 {flyOnCarpet} * Fly on Magic Carpet
3900 {takeInvisibilityPotion} *Take invisibility potion
4000 {eraseDisplayedWalls} *Erase displayed walls unless below visible
4005 {drawDisplayedWalls} *Draw displayed walls 
4110 {stairsHandler} *Handle Stairs
4250 {checkBossMonster} *_Check for boss monster
4255 {} *Create Spectre
4256 {createSerpent} *Create Serpent
4259 {exitBossMonster} exit boss monster creation
4260 {createDragon} *Create Dragon
4310 {searchTreasure} *Search for treasure
4510 {foundMonster} *_Bumped into monster
4800 {necroPtero} *Bumped into necromancer/pterodactyl
4910 {pitTrap} *Bumped into pit trap
5000 {moveFail} *Bumped into solid wall, sfx and recheck.
6000 {exitMaze} *Exit the Maze
6005 {} Play victory tune
6006 {} Victory Status
7000 {moveDragon} *Move Dragon
8000 {foundDragon} *Bumped into dragon
8300 {colourCodes} *Display Colour Codes
8325 {allDied} *Party has been wiped out.

# 0 nothing x1 wall right x2 wall below x3 wall right and below
# 2x pit trap 3x necromancer/pterodactyl 4x monster (no treasure) 5x stairs 6x rock 7x treasure
# 8x monster with treasure 9x gas , -ve if not displayed yet.


# TODO:
# 40-60 		Serpent Move code
# 500-707 		Spectre Move code
# 780-785 		Machine code music playing.
# 3755-3781 	Carpet Code
# 4000-4040 	Draw/erase wall
# 4100-4220 	Stairway code 
# 4255-4270 	Boss creation (x3)
# 4310-4440 	Search for treasure and random objects
# 4510-4750 	Battle
# 4800-4805 	Necromancer/Pterodactyl
# 4910-4951 	Pit Trap
# 5000 			?
# 5045-5050 	End of treasure found ?
# 7000-8002 	Move Dragon


