   1  # ****************************************************************************************************
      # ****************************************************************************************************
      #
      #
      #             Dungeon Campaign by Robert Clardy. Reverse engineered by Paul Robson 2017
      #
      #
      # ****************************************************************************************************
      # ****************************************************************************************************
      Goto Initialise.769
   5  # ****************************************************************************************************
      #                                         Delay two seconds
      # ****************************************************************************************************
      For i = 1 To 1000
      Next i
   6  # ****************************************************************************************************
      #                                           Delay a second
      # ****************************************************************************************************
      For i = 1 To 500
      Next i
   7  # ****************************************************************************************************
      #                                        Delay half a second
      # ****************************************************************************************************
      For i = 1 To 500
      Next i
      Return
  10  # ****************************************************************************************************
      #                           Draw Square, current colour, current position.
      # ****************************************************************************************************
      Vlin yScreen,yScreen + 1 At xScreen
      Vlin yScreen,yScreen + 1 At xScreen + 1
      Return
  11  # ****************************************************************************************************
      #                Convert xPos,yPos to position in maze, contents and screen position
      # ****************************************************************************************************
      mazeIndex = level * 169 + xPos + 13 *(yPos - 1)
      xScreen = 3 * xPos - 2
      yScreen = 3 * yPos - 2
      mazeContents = maze(mazeIndex) / 10
      Return
  12  # ****************************************************************************************************
      #                              Find an empty slot (upper digit is zero)
      # ****************************************************************************************************
      xPos = Rnd(11) + 2
      yPos = Rnd(11) + 2
      Gosub Convertposition.11
      If mazeContents # 0 Then Findemptyslot.12
      Return
  13  # ****************************************************************************************************
      #                         Find a square which is the upper left of open four
      # ****************************************************************************************************
      Gosub Findemptyslot.12
      If maze(mazeIndex + 1) < - 5 Or maze(mazeIndex + 13) < - 5 Or maze(mazeIndex + 14) < - 5 Then Opensquareroom.13
      maze(mazeIndex) = 0
  14  # erase on the display
      Color= 0
      For j = 0 To 4
          Vlin yScreen,yScreen + 4 At xScreen + j
      Next j
  15  # on first two levels, make the first one a gas area (9x)
      If(level # 1 And level # 2) Or i # 1 Then Opensquarewalls.16
      For j = 0 To 1
          For mazeContents = 0 To 1
              maze(mazeIndex + j + 13 * mazeContents) = maze(mazeIndex + j + 13 * mazeContents) - 90
      Next mazeContents,j
  16  # remove walls to make a square. move to one of the 4 squares randomly.
      maze(mazeIndex + 1) = maze(mazeIndex + 1) + 2 *((maze(mazeIndex + 1) Mod 10) = - 2)
      maze(mazeIndex + 13) = maze(mazeIndex + 13) +((maze(mazeIndex + 13) Mod 10) = - 1)
      mazeIndex = mazeIndex + Rnd(2) + 13 *(Rnd(2))
      Return
  18  # ****************************************************************************************************
      #
      #                                   Read Keyboard Checking for Gas
      #
      # ****************************************************************************************************
      key = Peek(- 16384)
      If key < 128 Then Nokey.20
      Poke - 16368,0
      noGas = 1
      Return
  20  # No check for gas if there is none and not the serpent boss, move serpent ? back if count not mod =0
      If noGas = 1 And bossStatus # 3 Then Readkeyboardgascheck.18
      If bossStatus = 3 Then Gosub Moveserpent.40
      gasTimeOut = gasTimeOut + 1
      If(gasTimeOut Mod(5 + 15 *(bossStatus # 3))) # 0 Or noGas = 1 Then Readkeyboardgascheck.18
  25  # dec gas count , loop back if not time out or counter not mod 0
      Tab 35
      gasTime = gasTime -(gasTime > 0)
      Print gasTime;
      If gasTime # 0 Or((gasTimeOut Mod(10 + 30 *(bossStatus # 3))) # 0) Then Readkeyboardgascheck.18
  30  # one of the party dies, back to prompt.
      partySize = partySize - 1
      Print
      Print " one of your party died from the gas.";
      Gosub Delaytwosec.5
      If partySize <= 0 Then Alldied.8325
      Pop
      Goto Prompt.1500
  40  # ****************************************************************************************************
      #              Move the serpent. info = direction. Pick a move in one of the directions
      # ****************************************************************************************************
      m = 1
      i = Rnd(2)
      xBoss = xSerpent(1) + xBossInfo * i
      yBoss = ySerpent(1) + yBossInfo *(i = 0)
  41  # if off screen try other direction
      If xBoss < 1 Or yBoss < 1 Or xBoss > 38 Or yBoss > 38 Then 60
  42  # check head got player (5), check wall and gas (9)
      n = Scrn(xBoss,yBoss)
      If n = colours(5) Then 50
      If n = colours(level + 1) Mod 16 Or n = colours(9) Then 60
      m = 1
      u = Scrn(xSerpent(8),ySerpent(8))
      Color= u +(8 *(u # 0))
  45  # move serpent graphic, clear tail, move others down one.
      Plot xSerpent(8),ySerpent(8)
      Color= 8 +(n *(n # 8))
      Plot xBoss,yBoss
      For i = 8 To 1 Step - 1
          xSerpent(i) = xSerpent(i - 1)
          ySerpent(i) = ySerpent(i - 1)
      Next i
      Return
  47  # come here if trying other way fails.
      m = 1
      xBossInfo =(xBoss = 1) -(xBoss = 38)
      yBossInfo =(yBoss = 1) -(yBoss = 38)
      If xBossInfo = 0 Then xBossInfo = 2 * Rnd(2) - 1
      If yBossInfo = 0 Then yBossInfo = 2 * Rnd(2) - 1
      Goto Moveserpent.40
  50  # serpent ate a party member
      Color= 8
      Plot xBoss,yBoss
      Gosub Delaysec.6
      Call - 936
      Print
      Print " the serpent ate one of your party!"
      Color= 0
      Gosub Delayhalfsec.7
  55  # erase the serpent. (Doesn't check if party zero size)
      Plot xBoss,yBoss
      For i = 1 To 8
          Plot xSerpent(i),ySerpent(i)
          For j = 1 To 200
      Next j,i
      bossStatus = 0
      partySize = partySize - 1
      Pop
      Goto 3750
  60  # trying a direction fails ; try the other one ; if already done that (m = 0) pick a random direction.
      If m = 0 Then 47
      xBoss = xBoss - xBossInfo * i + xBossInfo *(i = 0)
      yBoss = yBoss - yBossInfo *(i = 0) + yBossInfo * i
      m = 0
      Goto 41
 500  # ****************************************************************************************************
      #                          Move the Spectre. Just floats about chasing you.
      # ****************************************************************************************************
      d = 0
      u = 625
      Gosub Drawerasespectre.600
      u = 620
      xBossInfo = xBossInfo + Sgn(xScreen - xBossInfo) -(yScreen = yBossInfo)
      yBossInfo = yBossInfo + Sgn(yScreen - yBossInfo) -(xScreen = xBossInfo)
      Gosub Drawerasespectre.600
      If d = 1 Then Spectregotparty.700
      dragonMoveCount = 0
      Return
 600  # ****************************************************************************************************
      #                                          Draw the Spectre
      # ****************************************************************************************************
      For i = - 1 To 2
          l = yBossInfo
          r = xBossInfo + i
          Gosub u
          l = yBossInfo + 1
          Gosub u
      Next i
      For i = 0 To 1
          l = yBossInfo - 1
          r = xBossInfo + i
          Gosub u
          l = yBossInfo + 2
          Gosub u
      Next i
      Return
 620  # ****************************************************************************************************
      #                                   Draw Spectre check for player.
      # ****************************************************************************************************
      If Scrn(r,l) = colours(5) Then d = 1
      Color= colours(16)
      If Scrn(r,l) = 0 Then Plot r,l
      Return
 625  # ****************************************************************************************************
      #                                  Erase Spectre check for player.
      # ****************************************************************************************************
      Color= 0
      If Scrn(r,l) = colours(16) Then Plot r,l
      Return
 700  # ****************************************************************************************************
      #                                         Spectre got party
      # ****************************************************************************************************
      Call - 936
      Print
      Print "the spectre got one of your party!"
      bossStatus = 0
 705  # Erase the Spectre
      u = 620
      Gosub Drawerasespectre.600
      Color= colours(5)
      If Scrn(xBossInfo,yBossInfo) = colours(16) Then Plot xBossInfo,yBossInfo
      Color= colours(16)
      If Scrn(xBossInfo + 1,yBossInfo) = colours(5) Then Plot xBossInfo + 1,yBossInfo
      u = 625
      Gosub Drawerasespectre.600
 707  xBossInfo = xBossInfo - 1
      If xBossInfo > 1 Then Removespectre.705
      Plot xBossInfo + 1,yBossInfo
      partySize = partySize - 1
      Pop
      Goto 3750
 769  # ****************************************************************************************************
      #
      #                                          Initialise Game
      #
      # ****************************************************************************************************
      Rem
 770  # display title page (poke 50,63 is inverse poke 50,127 is normal)
      Poke 50,63
      Gosub Delaytwosec.5
      Vtab 21
      Tab 17
      Print " by "
      Print
      Tab 14
      Print "robert clardy"
      Gosub Delaytwosec.5
 777  Vtab 21
      Tab 11
      Print "copyright(c) 1979"
      Print
      Tab 9
      Print "by synergistic software"
      Gosub Delaysec.6
      Poke 50,255
 780  # ****************************************************************************************************
      #                     install machine code for sound see sound.asm and music.ods
      # ****************************************************************************************************
      Poke 2,173
      Poke 3,48
      Poke 4,192
      Poke 5,165
      Poke 6,0
      Poke 7,32
      Poke 8,168
      Poke 9,252
      Poke 10,165
      Poke 11,1
      Poke 12,208
 785  Poke 13,4
      Poke 14,198
      Poke 15,24
      Poke 16,240
      Poke 17,5
      Poke 18,198
      Poke 19,1
      Poke 20,76
      Poke 21,2
      Poke 22,0
      Poke 23,96
 790  Dim xSerpent(8),ySerpent(8),colours(16)
      xBoss = 0
      yBoss = 0
      partySize = 15
      strength = 1
      noGas = 1
      gasTime = 9
      colours(1) = 12
      colours(2) = 3
      colours(3) = 9
      colours(4) = 11
      colours(5) = 1
      colours(6) = 7
 795  colours(7) = 7
      colours(8) = 4
      colours(9) = 15
      colours(10) = 0
      colours(11) = 13
      colours(12) = 4
      colours(13) = 14
      colours(14) = 5
      colours(16) = 10
      Goto Createmaze.801
 801  # ****************************************************************************************************
      #
      #                                          Create the maze
      #
      # ****************************************************************************************************
      Rem
 802  # ****************************************************************************************************
      #                  dimension 13x13x4 maze and fill with '3' (wall right and below)
      # ****************************************************************************************************
      Dim maze(676)
      For i = 1 To 676
          maze(i) = 3
      Next i
1001  # ****************************************************************************************************
      #                                         Do for each level.
      # ****************************************************************************************************
      For level = 0 To 3
          Gr
          Print
          Print
          Tab 8
          Print "this is the map for level ";level + 1
          Color= colours(level + 1)
1003  # Fill whole screen with the correct background colour (visuals only)
          For i = 0 To 39
              Vlin 0,39 At i
          Next i
          Color= 0
          Gosub Findemptyslot.12
          mazeClearCount = 121
1030  # ****************************************************************************************************
      #                                      Find the start position
      # ****************************************************************************************************
          Gosub Findemptyslot.12
          If maze(mazeIndex) < 0 Then 1030
          mazeClearCount = 121
1035  # ****************************************************************************************************
      #             Clear the next square in the maze. When done set all non-open walls to -63
      # ****************************************************************************************************
          If mazeClearCount # 1 Then Clearonesquare.1040
          Color= colours(level + 1)
          For mazeIndex = level * 169 + 1 To(level + 1) * 169
              If maze(mazeIndex) > 0 Then maze(mazeIndex) = - 63
1036      Next mazeIndex
          Goto Dorooms.1200
1040  # ****************************************************************************************************
      #                                 Clear a single square in the maze.
      # ****************************************************************************************************
          r = 0
          d = 0
          l = 0
          u = 0
          Gosub Convertposition.11
          Gosub Drawsquare.10
          maze(mazeIndex) = - Abs(maze(mazeIndex))
          mazeClearCount = mazeClearCount - 1
1050  # figure out which way we can go e.g. is there a wall there ?
          If xPos # 13 Then r = maze(mazeIndex + 1) > 0
          If yPos # 13 Then d = maze(mazeIndex + 13) > 0
          If xPos # 1 Then l = maze(mazeIndex - 1) > 0
          If yPos # 1 Then u = maze(mazeIndex - 13) > 0
1080  # if there is a used square near by, find a new starting point
          mazeContents = r + d + l + u
          If(mazeContents < 3 And Rnd(10) < 2) Or mazeContents = 0 Then Newstartpoint.1170
1110  # dispatch to movers
          Goto 1130 + 10 * Rnd(4)
1130  # try to move right
          If Not r Then Trymovedirection.1110
          maze(mazeIndex) = maze(mazeIndex) + 1
          xPos = xPos + 1
          Vlin 3 * yPos - 2,3 * yPos - 1 At 3 *(xPos - 1)
          Goto Nextclear.1035
1140  # try to move down
          If Not d Then Trymovedirection.1110
          maze(mazeIndex) = maze(mazeIndex) + 2
          yPos = yPos + 1
          Hlin 3 * xPos - 2,3 * xPos - 1 At 3 *(yPos - 1)
          Goto Nextclear.1035
1150  # try to move left
          If Not l Then Trymovedirection.1110
          maze(mazeIndex - 1) = maze(mazeIndex - 1) - 1
          xPos = xPos - 1
          Vlin 3 * yPos - 2,3 * yPos - 1 At 3 * xPos
          Goto Nextclear.1035
1160  # try to move up
          If Not u Then Trymovedirection.1110
          maze(mazeIndex - 13) = maze(mazeIndex - 13) - 2
          yPos = yPos - 1
          Hlin 3 * xPos - 2,3 * xPos - 1 At 3 * yPos
          Goto Nextclear.1035
1170  # ****************************************************************************************************
      #                         Find a new start point as we can't go any further.
      # ****************************************************************************************************
          xPos = Rnd(13) + 1
          yPos = Rnd(13) + 1
          Gosub Convertposition.11
          If maze(mazeIndex) > 0 Then Newstartpoint.1170
          mazeClearCount = mazeClearCount + 1
          Goto Nextclear.1035
1200  # ****************************************************************************************************
      #                       Create 5 square rooms. 3-5 have treasure in them (7x)
      # ****************************************************************************************************
          For i = 1 To 5
              Gosub Opensquareroom.13
              If i > 2 Then maze(mazeIndex) = maze(mazeIndex) - 70
          Next i
          Poke 0,4
          Poke 24,8
          Call 2
      Next level
1205  # ****************************************************************************************************
      #    Put pits (2x) necro/ptero (3x) monster/w treasure (8x) stairs (5x) monster no treasure (4x)
      # ****************************************************************************************************
      Rem
1210  For level = 0 To 3
          For i = 1 To 2
1212  # Pits, check there is something to fall through to.
              Gosub Findemptyslot.12
              If maze(mazeIndex + 169 *(level < 3)) / 10 = - 6 Or maze(mazeIndex + 338 *(level < 2)) / 10 = - 6 Then 1212
              maze(mazeIndex) = maze(mazeIndex) - 20
              Gosub Findemptyslot.12
              maze(mazeIndex) = maze(mazeIndex) - 30
              Gosub Findemptyslot.12
              maze(mazeIndex) = maze(mazeIndex) - 80
1215  # No stairs on L1
          Next i
          For i = 1 To 3
              If level = 0 Then 1220
              Gosub Findemptyslot.12
              If maze(mazeIndex - 169) < - 5 Then 1215
              maze(mazeIndex) = maze(mazeIndex) - 50
1220  # One treasureless monster.
          Next i
          Gosub Findemptyslot.12
          maze(mazeIndex) = maze(mazeIndex) - 40
      Next level
      level = 3
1260  # ****************************************************************************************************
      #                 Special stuff Level 4. Find position on edge. Find start position
      # ****************************************************************************************************
      Gosub Findemptyslot.12
      i = Rnd(2)
      j = Rnd(2)
      If i Then xPos = j * 13
      If Not i Then yPos = j * 13
      Gosub Convertposition.11
      If Abs(maze(mazeIndex) / 10) # 0 Then 1260
      xExit = xPos
      yExit = yPos
      level = 0
      Gosub Findemptyslot.12
1265  # Draw Frame
      Gr
      Color= colours(5)
      Gosub Drawsquare.10
      Color= colours(1)
      Hlin 0,39 At 0
      Hlin 0,39 At 39
      Vlin 0,39 At 0
      Vlin 0,39 At 39
      Gosub Drawraw.4010
1280  Dim a$(15),monsterName$(250),c$(5)
1290  # Get monster Names
      monsterName$ = "lycanthropesgargoyles balrogs vampires goblins mighty ogresvicious orcscyclopses skeletons "
1292  monsterName$(109) = "zombies evil trolls mummies huge spiderswerewolves minotaurs centaurs berserkers griffons "
1294  monsterName$(217) = "basilisks gorgons "
1300  Goto Displaycommands.1560
1500  # ****************************************************************************************************
      #                                 Prompt for command, check for gas
      # ****************************************************************************************************
      Call - 936
      Print
      Tab 10
      Print "what is your command?"
      Tab 5
      noGas =((maze(mazeIndex) / 10) # 9)
      If noGas = 0 Then Print "gas exposure time remaining = ";gasTime;
1501  # ****************************************************************************************************
      #                            Get command, update bosses if not invisible.
      # ****************************************************************************************************
      Gosub Readkeyboardgascheck.18
      If invisible = 15 Then Executecommand.1520
      If bossStatus = 0 Then Gosub Checkbossmonster.4250
      If bossStatus = 2 Then Gosub Movespectre.500
      If dragonMoveCount > 0 Then Gosub Movedragon.7000
1520  # Execute Command
      If key = 210 Then Moveright.2000
      If key = 204 Then Moveleft.2500
      If key = 213 Then Moveup.3000
      If key = 196 Then Movedown.3500
      If hasCarpet And key = 198 Then Flyoncarpet.3755
1530  If key = 211 Then Searchtreasure.4310
      If key = 195 Then Colourcodes.8300
      If key = 202 Then Jump.3700
      If key = 197 Then Exitmaze.6000
      If key = 216 Then Displaystatus.3740
      If invisible > 1 And key = 201 Then Takeinvisibilitypotion.3900
1560  # Display command list
      Poke 50,63
      Print
      Print " legal commands are: ";
      Poke 50,255
      Tab 1
      If hasCarpet Then Print "f=fly ";
1565  Tab 32
      If invisible > 1 Then Print "i=invis ";
      If invisible = 0 Then Print
      Print "l=left u=up e=exit"
1570  Print "r=right s=search j=jump"
      Print "d=down x=status c=colors";
      Goto Getcommand.1501
2000  # ****************************************************************************************************
      #                                             Move Right
      # ****************************************************************************************************
      If maze(mazeIndex) Mod 2 # 0 Then Movefail.5000
      xMove = 1
      yMove = 0
2020  # ****************************************************************************************************
      #
      #   General Move Code (validated in maze). Erase if dwarf dead, animate movement, do actual move.
      #
      # ****************************************************************************************************
      If dwarfDead Then Gosub Erasedisplayedwalls.4000
      For i = 1 To 3
          Color=(colours(13)) *((maze(mazeIndex) / 10) = 9)
          Gosub Drawsquare.10
          Color= invisible + colours(5)
          xScreen = xScreen + xMove
          yScreen = yScreen + yMove
          Gosub Drawsquare.10
      Next i
      xPos = xPos + xMove
      yPos = yPos + yMove
2100  # Reconvert position. , if not in gas
      Gosub Convertposition.11
      If mazeContents # - 9 Then Completemove.2120
      i = xPos
      j = yPos
      xPos = xPos - 1
      yPos = yPos - 1
2102  # ****************************************************************************************************
      #                 Make Gas area visible Look in [-1,-1] [0,-1] [-1,0] [0,0] for gas
      # ****************************************************************************************************
      Gosub Convertposition.11
      If mazeContents = - 9 Then 2105
      xPos = xPos + 1
      If xPos = i Then 2102
      yPos = yPos + 1
      xPos = xPos - 2
      Goto 2102
2105  # Draw gas cells
      Color= colours(13)
      For u = 0 To 4
          Vlin yScreen,yScreen + 4 At xScreen + u
      Next u
      Gosub Drawdisplayedwalls.4005
      xPos = xPos + 1
      Gosub Drawdisplayedwalls.4005
      yPos = yPos + 1
      Gosub Drawdisplayedwalls.4005
      xPos = xPos - 1
      Gosub Drawdisplayedwalls.4005
      xPos = i
      yPos = j
2110  # Redraw player
      Gosub Convertposition.11
      Color= invisible + colours(5)
      Gosub Drawsquare.10
2120  # ****************************************************************************************************
      #                 Show walls, update dragon count, if jumping do it again w/o checks
      # ****************************************************************************************************
      Gosub Drawdisplayedwalls.4005
      If bossStatus = 1 Then dragonMoveCount = dragonMoveCount + 1
      If monsterInPlay # 0 Then Attackmonster.4550
      If Not isJumping Then Checkmoveresult.2130
      isJumping = 0
      Goto Executecommand.1520
2130  # get new maze contents, handle stairs (5) or stairs on next level (+169)
      j = 1
      mazeContents = Abs(mazeContents)
      If level # 0 And mazeContents = 5 Then Stairshandler.4110
      j = 0
      If level # 3 Then If Abs(maze(mazeIndex + 169) / 10) = 5 Then Stairshandler.4110
2145  # if elf dead then no warning.
      If elfDead Or(level = 0 And yPos = 1) Or(level = 3 And yPos = 13) Then Exitmove.2170
2150  # check in four directions for pit trap/necromancer/pterodactyl
      For d = - 1 To 1 Step 2
          For u = 1 To 13 Step 12
              i = Abs(maze(mazeIndex + d * u) / 10)
              If i = 2 Or i = 3 Then Reportdanger.2160
      Next u,d
      Goto Exitmove.2170
2160  # report danger near
      Poke 50,127
      Call - 936
      Print
      Tab 10
      Print "beware! danger near!"
      Poke 50,255
      Gosub Delayhalfsec.7
2170  # ****************************************************************************************************
      #                   Check what you hit : monster (4 or 8) 2 (pit) 3 (necro/ptero)
      # ****************************************************************************************************
      If mazeContents = 4 Or mazeContents = 8 Then Foundmonster.4510
      If bossStatus = 1 And invisible # 15 And xPos = xBoss And yPos = yBoss Then Founddragon.8000
      If mazeContents = 3 Then Necroptero.4800
      If mazeContents = 2 Then Pittrap.4910
      Goto Prompt.1500
2500  # ****************************************************************************************************
      #                                             Move Left
      # ****************************************************************************************************
      If xPos = 1 Then Movefail.5000
      If maze(mazeIndex - 1) Mod 2 # 0 Then Movefail.5000
      xMove = - 1
      yMove = 0
      Goto Movecode.2020
3000  # ****************************************************************************************************
      #                                              Move Up
      # ****************************************************************************************************
      If yPos = 1 Then Movefail.5000
      If(Abs(maze(mazeIndex - 13) Mod 10)) > 1 Then Movefail.5000
      xMove = 0
      yMove = - 1
      Goto Movecode.2020
3500  # ****************************************************************************************************
      #                                             Move Down
      # ****************************************************************************************************
      If(Abs(maze(mazeIndex) Mod 10)) > 1 Then Movefail.5000
      xMove = 0
      yMove = 1
      Goto Movecode.2020
3700  # ****************************************************************************************************
      #                                            Jump Hazard
      # ****************************************************************************************************
      isJumping = 1
      Call - 936
      Print
      Tab 15
      Print "direction?"
      Gosub Readkeyboardgascheck.18
      Goto Executecommand.1520
3740  # ****************************************************************************************************
      #                                           Display Status
      # ****************************************************************************************************
      Call - 936
      c$ = "alive"
      If elfDead Then c$ = "dead"
      Print "the elf is ";c$;". the dwarf is ";
      c$ = "alive"
      If dwarfDead Then c$ = "dead"
      Print c$;"."
3750  Print "your party now numbers ";partySize
      Print "total strength = ";partySize * strength
3751  Print "your treasure is worth ";treasure;" quadroons.";
      Goto Getcommand.1501
3755  # ****************************************************************************************************
      #                                        Fly on Magic Carpet
      # ****************************************************************************************************
      bx = 2 * Rnd(2) - 1
      by = 2 * Rnd(2) - 1
3760  # only horizontal or vertical
      i = Rnd(2)
      xMove = bx *(i = 0)
      yMove = by * i
3765  # reached a wall, change direction
      If(xPos = 13 And xMove = 1) Or(yPos = 13 And yMove = 1) Or(xPos = 1 And xMove = - 1) Or(yPos = 1 And yMove = - 1) Then Flyoncarpet.3755
      If(Abs(maze(mazeIndex + xMove + 13 * yMove)) / 10) = 6 Then Flyoncarpet.3755
3770  # animate the movement vertically
      If i Then 3780
      For i = 1 To 3
          Color= Scrn(xScreen + xMove +(xMove = 1),yScreen) + colours(5)
          Vlin yScreen,yScreen + 1 At xScreen + xMove +(xMove = 1)
3771      Color= 16 + Scrn(xScreen +(xMove # 1),yScreen) - colours(5)
          Vlin yScreen,yScreen + 1 At xScreen +(xMove # 1)
          xScreen = xScreen + xMove
      Next i
      xPos = xPos + xMove
3775  # update map/pos , keep going until key pressed, go to monster if monster was in play
      Gosub Convertposition.11
      Gosub Drawdisplayedwalls.4005
      If Peek(- 16384) < 128 Then 3760
      Poke - 16368,0
      hasCarpet = 0
      If monsterInPlay Then 4555
      Goto Checkmoveresult.2130
3780  # animate the movement horizontally
      For i = 1 To 3
          Color= Scrn(xScreen,yScreen + yMove +(yMove = 1)) + colours(5)
          Hlin xScreen,xScreen + 1 At yScreen + yMove +(yMove = 1)
3781      Color= 16 + Scrn(xScreen,yScreen +(yMove # 1)) - colours(5)
          Hlin xScreen,xScreen + 1 At yScreen +(yMove # 1)
          yScreen = yScreen + yMove
      Next i
      yPos = yPos + yMove
      Goto 3775
3900  # ****************************************************************************************************
      #                                      Take invisibility potion
      # ****************************************************************************************************
      invisible = 15 *(invisible = 16)
      Color= invisible + colours(5)
      Gosub Drawsquare.10
      Goto Noisegetcmd.5050
4000  # ****************************************************************************************************
      #                             Erase displayed walls unless below visible
      # ****************************************************************************************************
      Color= colours(level + 1) *(colours(level + 1) > 16)
      Goto Drawraw.4010
4002  # ****************************************************************************************************
      #                            Hide current square as first time, draw it.
      # ****************************************************************************************************
      maze(mazeIndex) = - Abs(maze(mazeIndex))
      Goto Drawraw.4010
4005  # ****************************************************************************************************
      #                                        Draw displayed walls
      # ****************************************************************************************************
      Color= colours(level + 1)
      Gosub Convertposition.11
4010  # draw current cell
      p = maze(mazeIndex)
      If p > 0 And mazeContents # 5 Then Return
      If dwarfDead = 0 Then maze(mazeIndex) = Abs(p) + 10 *(p = 0)
      If xPos > 12 Then 4020
      If maze(mazeIndex + 1) > 0 And noGas Then 4020
4015  # vertical wall
      If p Mod 2 # 0 Then Vlin 3 *(yPos - 1),3 * yPos At 3 * xPos
4020  # vertical wall square to left
      If xPos > 1 Then If maze(mazeIndex - 1) Mod 2 = - 1 Then Vlin 3 *(yPos - 1),3 * yPos At 3 *(xPos - 1)
4030  # horizontal wall square above
      If yPos > 1 Then If(maze(mazeIndex - 13) Mod 10) < - 1 Then Hlin 3 *(xPos - 1),3 * xPos At 3 *(yPos - 1)
4040  # horizontal wall this square
      If yPos > 12 Then Return
      If noGas And maze(mazeIndex + 13) > 0 Then Return
      If(p Mod 10) < - 1 Then Hlin 3 *(xPos - 1),3 * xPos At 3 * yPos
      Return
4110  # ****************************************************************************************************
      #                                           Handle Stairs
      # ****************************************************************************************************
      Color= colours(9)
      i = Sgn(maze(mazeIndex))
      noGas = 0
      Gosub Hideanddraw.4002
      If i > 0 Then maze(mazeIndex) = Abs(maze(mazeIndex))
      noGas = 1
      a$ = "down"
      If j Then a$ = "up"
4115  # open up either up or down space.
      If j = 0 And level < 3 Then maze(mazeIndex + 169) = Abs(maze(mazeIndex + 169))
      If j And level Then maze(mazeIndex - 169) = Abs(maze(mazeIndex - 169))
4120  # ask if using stairs
      Call - 936
      Print
      Tab 7
      Print "stairway. go ";a$;" it(y/n)?"
4130  # if yes, little tune
      Gosub Readkeyboardgascheck.18
      If key # 217 Then 2145
      level = level - j +(j = 0)
      For i = j * 8 + 8 To(j = 0) * 8 + 8 Step((j = 0) - j)
          Poke 0,i
          Poke 24,2
          Call 2
4145  # update values & enter new level
          For mazeContents = 1 To 70
      Next mazeContents,i
      Gosub Convertposition.11
      Call - 936
      Gosub Enternewlevel.4150
      Goto Checkmoveresult.2130
4150  # ****************************************************************************************************
      #                                 Enter a new level, reset evrything
      # ****************************************************************************************************
      Gr
      Color= colours(5)
      Gosub Drawsquare.10
      monsterInPlay = 0
      noGas = 0
      bossStatus = 0
      xBoss = - 1
      yBoss = - 1
      If invisible = 15 Then invisible = 0
4160  # draw the frame
      Color= colours(level + 1)
      Vlin 0,39 At 0
      Vlin 0,39 At 39
      Hlin 0,39 At 0
      Hlin 0,39 At 39
      If colours(level + 1) > 15 Then 4420
4170  # redraw the bits we've already seen.
      j = xPos
      u = yPos
      For xPos = 1 To 13
          For yPos = 1 To 13
              Gosub Convertposition.11
              If maze(mazeIndex) <= 0 Then 4190
              Color= colours(level + 1)
              Gosub Hideanddraw.4002
              maze(mazeIndex) = Abs(maze(mazeIndex))
4180          If level # 3 Then If(maze(mazeIndex + 169) / 10) = 5 Then mazeContents = 5
              Color= colours(mazeContents + 4)
              If mazeContents = 6 Then Color= colours(level + 1)
              If mazeContents = 5 Then Gosub Hideanddraw.4002
              If mazeContents # 5 And mazeContents > 1 Then Gosub Drawsquare.10
4190  Next yPos,xPos
      noGas = 1
      xPos = j
      yPos = u
      Gosub Drawdisplayedwalls.4005
4220  # draw exit if required.
      Color= 0
      If level = 3 And(yExit = 0 Or yExit = 13) Then Hlin 3 * xExit - 2,3 * xExit - 1 At 3 * yExit
      If level = 3 And(xExit = 0 Or xExit = 13) Then Vlin 3 * yExit - 2,3 * yExit - 1 At 3 * xExit
      Return
4250  # ****************************************************************************************************
      #
      #                              Check for boss monster / Create Spectre
      #
      # ****************************************************************************************************
      dragonMoveCount = 0
      If Rnd(30) > 0 Then Return
      If level < 2 Then Createdragon.4260
      If level = 2 Then Createserpent.4256
      bossStatus = 2
      u = 620
      xBossInfo = 36
      yBossInfo = 36
      Gosub Drawerasespectre.600
      Poke 50,63
      Call - 936
      For i = 1 To 83
          Print " ";
      Next i
4255  # ****************************************************************************************************
      #                                        Display Information
      # ****************************************************************************************************
      Print "a spectre has entered the dungeon";
      For i = 1 To 83
          Print " ";
      Next i
      Poke 50,255
      Goto Exitbossmonster.4259
4256  # ****************************************************************************************************
      #                           Create Serpent. Find empty slot, assign to [8]
      # ****************************************************************************************************
      u = xPos
      d = yPos
      xBossInfo = 1
      yBossInfo = 1
      Gosub Findemptyslot.12
      bossStatus = 3
      Color= 8
      Plot xScreen,yScreen
      xSerpent(8) = xScreen
      ySerpent(8) = yScreen
      For i = 8 To 2 Step - 1
4257  # for each segment find a move that's open and store that in [7]-[1]
          yMove = 0
          xMove = Rnd(3) - 1
          If xMove = 0 Then yMove = 2 * Rnd(2) - 1
          If Scrn(xSerpent(i) + xMove,ySerpent(i) + yMove) = colours(level + 1) Mod 16 Then 4257
          xSerpent(i - 1) = xSerpent(i) + xMove
4258  # draw it, announce it, fix up variables with player.
          ySerpent(i - 1) = ySerpent(i) + yMove
          Plot xSerpent(i - 1),ySerpent(i - 1)
          For j = 1 To 100
      Next j,i
      Call - 936
      Print
      Print "a giant serpent has entered the dungeon!"
      xPos = u
      yPos = d
4259  # exit boss monster creation
      Gosub Delaysec.6
      Gosub Convertposition.11
      Return
4260  # ****************************************************************************************************
      #                                           Create Dragon
      # ****************************************************************************************************
      bossStatus = 1
      xBossInfo = xPos
      yBossInfo = yPos
4265  # Find empty slot for dragon, at least six squares away. Fix back and update player pos
      Gosub Findemptyslot.12
      If Abs(xPos - xBossInfo) + Abs(yPos - yBossInfo) < 6 Then 4265
      Color= colours(14)
      Gosub Drawsquare.10
      xBoss = xPos
      yBoss = yPos
      xPos = xBossInfo
      yPos = yBossInfo
      xBossInfo = xScreen
      yBossInfo = yScreen
      Gosub Convertposition.11
4267  # announce warning message
      Call - 936
      Print
      Poke 50,127
      Print "danger!!!";
      Poke 50,63
      Print " you woke a man-eating dragon!"
      Poke 50,255
4270  # play sound , click speaker repeatedly.
      For i = 1 To 70
          d = Peek(- 16336)
          For j = 1 To 3
      Next j,i
      Goto Exitbossmonster.4259
4310  # ****************************************************************************************************
      #                                        Search for treasure
      # ****************************************************************************************************
      Gosub Convertposition.11
      If mazeContents = 7 Or mazeContents = 8 Then Foundtreasure.4325
      Call - 936
      Print
      Tab 10
      Print "sorry, no treasure here.";
      Goto Getcommand.1501
4325  # found treasure (7) w/monster (8), do sfx and gfx. remove it / convert to monster
      For j = 1 To 8
          d = j Mod 2
          Color= colours(5 + 6 * d)
          Gosub Drawsquare.10
          For l = 1 To 50
          Next l
          Poke 0,8 - d
          Poke 24,2
          Call 2
      Next j
      maze(mazeIndex) = maze(mazeIndex) - 40 -(30 *(mazeContents = 7))
4328  # work out treasure value
      l = 100 *(Rnd(10) + 2 + 4 * level)
4330  treasure = treasure + l
      Call - 936
      Print "you've found ";l;" quadroons worth of"
      Print "gold and jewels.";
      If Rnd(2) Then Getcommand.1501
4335  # other things we might have found.
      Print " you've also found "
      Goto 4370 + 10 * Rnd(8)
4345  i = xPos
      j = yPos
      For xPos = 1 To 13
          For yPos = 1 To 13
              Gosub Convertposition.11
              mazeContents = Abs(mazeContents)
              If mazeContents # u And mazeContents # d Then 4346
              Color= colours(u + 4)
              Gosub Drawsquare.10
              Gosub Drawdisplayedwalls.4005
4346  Next yPos,xPos
      Goto Recalccheck.5045
4370  # show stairways
      Color= colours(9)
      i = xPos
      j = yPos
      For xPos = 1 To 13
          For yPos = 1 To 13
              Gosub Convertposition.11
              If level # 0 And Abs(mazeContents) = 5 Then Gosub Drawraw.4010
4375          If level = 3 Then 4377
              mazeContents = Abs(maze(mazeIndex + 169) / 10)
              If mazeContents # 5 Then 4377
              Gosub Drawraw.4010
              maze(mazeIndex + 169) = Abs(maze(mazeIndex + 169))
4377  Next yPos,xPos
      Goto Recalccheck.5045
4380  # show treasure
      u = 7
      d = 8
      Goto 4345
4390  # show monsters
      u = 4
      d = 8
      Goto 4345
4400  # display other hazards
      u = 2
      d = 3
      Goto 4345
4410  # magic sword
      magicSword = 1
      Print "a magic sword(can be used only once).";
      Goto Noisegetcmd.5050
4420  # show current level
      i = xPos
      j = yPos
      colours(level + 1) = colours(level + 1) + 16
      For xPos = 1 To 13
          For yPos = 1 To 13
              Gosub Convertposition.11
              d =(mazeContents >= 0) -(mazeContents < 0)
              Gosub Drawdisplayedwalls.4005
              If Abs(mazeContents) = 6 Then Gosub Drawsquare.10
              maze(mazeIndex) = d * maze(mazeIndex)
4425  Next yPos,xPos
      Goto Recalccheck.5045
4430  Print "a magic carpet."
      hasCarpet = 1
      Goto Noisegetcmd.5050
4440  Print "an invisibility potion!";
      invisible = 16
      Goto Noisegetcmd.5050
4510  # ****************************************************************************************************
      #
      #                                        Bumped into monster
      #
      # ****************************************************************************************************
      xScreen = xScreen - 3 * xMove
      yScreen = yScreen - 3 * yMove
      xMonster = xScreen
      yMonster = yScreen
      Color= colours(8)
      Gosub Drawsquare.10
      monsterInPlay = 1
      tx = xPos
      ty = yPos
4521  # work out strength and type of monster
      monStrength = 15 + Rnd(10) + level * 20
      i = Rnd(20) * 12 + 1
      a$ = monsterName$(i,i + 11)
      Call - 936
      Print "you've come upon ";Rnd(19) + 5;" ";a$
4522  Gosub Convertposition.11
      Print "their strength is ";monStrength;" while yours"
      Print "is ";partySize * strength;". what is your command?"
      Goto Getcommand.1501
4550  # ****************************************************************************************************
      #
      #                                        Now in monster fight
      #
      # ****************************************************************************************************
      If xScreen = xMonster And yScreen = yMonster And invisible # 15 Then 4710
      If(xScreen = xMonster Or yScreen = yMonster) And invisible # 15 Then 4560
4555  Color= colours(8)
      xScreen = 3 * tx - 2
      yScreen = 3 * ty - 2
      Gosub Drawsquare.10
      Color= 0
      xScreen = xMonster
      yScreen = yMonster
      Gosub Drawsquare.10
      Gosub Convertposition.11
      monsterInPlay = 0
      Goto Checkmoveresult.2130
4560  xScreen = xMonster
      yScreen = yMonster
      For i = 1 To 6
          Color= 0
          Gosub Drawsquare.10
          Color= colours(8)
          xScreen = xScreen + xMove
          yScreen = yScreen + yMove
          Gosub Drawsquare.10
      Next i
      Gosub Convertposition.11
      Goto 4710
4710  For i = 1 To 6
          Poke 0,20
          Poke 24,2
          Color= colours(8)
          Gosub Drawsquare.10
          For l = 1 To 100
          Next l
          Color= colours(5)
          Gosub Drawsquare.10
          Call 2
      Next i
      i = level * 169 + tx + 13 *(ty - 1)
4711  maze(i) = maze(i) - 10 - 30 *((maze(i) / 10) = 4)
      Color= colours(8)
      Plot xScreen + 1,yScreen
      Plot xScreen,yScreen + 1
      If magicSword = 0 Then 4713
      Call - 936
      Print
      Tab 6
4712  Print "use your magic sword(y/n)?";
      Gosub Readkeyboardgascheck.18
      If key = 217 Then 4750
4713  Call - 936
      Print "battle has begun. hit space bar to roll dice for your attack. hit it again to stop dice.";
      mazeContents = 0
      j = 0
      Gosub Readkeyboardgascheck.18
4716  i = Rnd(10) + 1
      Print i
      If Peek(- 16384) < 128 Then 4716
      l =(partySize * strength * i) > monStrength * 3
      Poke - 16368,0
4718  Print "you rolled ";i;"."
      If l Then Print "you got a hit!"
      If Not l Then Print "no hit."
      j = j + l
4719  Print "now roll for the enemy.";
      Gosub Readkeyboardgascheck.18
4721  i = Rnd(10) + 1
      Print i
      If Peek(- 16384) < 128 Then 4721
      Poke - 16368,0
      mazeContents = mazeContents +(i > 7)
4722  Print
      Print "the enemy gets a ";i
      Print "you've lost ";mazeContents;" of your party."
      Gosub Delaysec.6
4723  If mazeContents >= partySize Then Alldied.8325
      If j = 2 Then 4730
      c$ = "none"
      If j Then c$ = "half"
      Print c$;" of the ";a$;" are dead."
4724  If mazeContents > 3 Then monStrength = monStrength / 2
4725  Print "roll again for your side.";
      Gosub Readkeyboardgascheck.18
      Goto 4716
4730  partySize = partySize - mazeContents
      strength = strength + 1
      If mazeContents And level And Not elfDead And Rnd(15) > partySize Then 4740
      If mazeContents And level = 2 And Not dwarfDead And Rnd(15) > partySize Then 4741
4731  Print
      Print "the ";a$;" were all killed."
      monsterInPlay = 0
      Goto 3750
4740  elfDead = 1
      Print
      Print "the elf was killed. no more warnings."
      Gosub Delaytwosec.5
      Goto 4731
4741  dwarfDead = 1
      Print
      Print "the dwarf was killed. no more map."
      Gosub Delaytwosec.5
      Goto 4731
4750  magicSword = 0
      strength = strength + monStrength / partySize
      Print
      Print "the magic sword killed the ";a$
      Color= colours(5)
      Gosub Drawsquare.10
      monsterInPlay = 0
      Goto 3750
4800  # ****************************************************************************************************
      #                                Bumped into necromancer/pterodactyl
      # ****************************************************************************************************
      Call - 936
      If Rnd(2) Then 4801
      Print "you disturbed an evil necromancer who sent you here."
      Goto 4802
4801  # alternate message, there's no other difference.
      Print "you were grabbed by pteridactyls, flown here and left."
4802  # play a little tune
      i = 20
      For j = 1 To 15
          Poke 0,i
          Poke 24,2
          i = i - 1
          Call 2
      Next j
      Poke 0,22
      Poke 24,2
      Call 2
4805  # find an empty slot in random place / draw new level / check result of move there.
      level = Rnd(3)
      Gosub Findemptyslot.12
      Gosub Enternewlevel.4150
      Goto Checkmoveresult.2130
4910  # ****************************************************************************************************
      #                                        Bumped into pit trap
      # ****************************************************************************************************
      Call - 936
      Print
      Poke 50,127
      Tab 14
      Print "pit trap!!!"
      Poke 50,255
      For i = 1 To 4
          Color= 1 +(i Mod 2) * 10
          Gosub Drawsquare.10
          For j = 1 To 6
              Poke 0,12
              Poke 24,2
4920  # special case on the bottom level,men lost. pick level to go to
              Call 2
      Next j,i
      If level = 3 Then Pitbottomlevel.4950
      level = level + Rnd(2) + 1
      If level > 3 Then level = 3
      Tab 8
      Print "you've fallen to level ";level + 1
4942  # update position and go there.
      Gosub Convertposition.11
      Gosub Enternewlevel.4150
      Goto 2100
4950  # at the bottom we lose men, which might be fatal.
      i = 1 + Rnd(2)
      partySize = partySize - i
      If partySize <= 0 Then Alldied.8325
      Print i;" of your men fell into the bottomless"
4951  Print "pit. there are only ";partySize;" of you left.";
      Goto Getcommand.1501
5000  # ****************************************************************************************************
      #                              Bumped into solid wall, sfx and recheck.
      # ****************************************************************************************************
      Poke 0,15
      Poke 24,2
      Call 2
      Goto 2100
5045  # ****************************************************************************************************
      #                                       Recalculate and check
      # ****************************************************************************************************
      xPos = i
      yPos = j
      Gosub Convertposition.11
      If noGas = 0 Then 4170
      Print "this map!"
5050  # SFX and get next command
      p = 9
      For i = 1 To 8
          Poke 0,p
          Poke 24,2
          Call 2
          p = p - 1
      Next i
      Goto Getcommand.1501
6000  # ****************************************************************************************************
      #                                           Exit the Maze
      # ****************************************************************************************************
      If Not(level = 3 And(xPos = xExit Or xPos = xExit + 1) And(yPos = yExit Or yPos = yExit + 1)) Then Movefail.5000
      maze(1) = 10
      maze(2) = 3
      maze(3) = 10
      maze(4) = 3
      maze(5) = 9
      maze(6) = 3
      maze(7) = 7
6005  # Play victory tune
      maze(8) = 8
      For j = 1 To 3
          If j = 3 Then maze(8) = 16
          For i = 1 To 7 Step 2
              Poke 0,maze(i)
              Poke 24,maze(i + 1)
              Call 2
      Next i,j
6006  # Victory Status
      Text
      Call - 936
      Vtab 10
      Print "you made it!!! you got out of the dun- geon with ";treasure;" quadroons worth of gold"
6010  Print "and jewels! only ";partySize;" of your party sur-"
      Print "vived though."
      Print "come again soon."
      End
7000  # ****************************************************************************************************
      #                            Move Dragon. Figure out which way it can go.
      # ****************************************************************************************************
      t = level * 169 + xBoss + 13 *(yBoss - 1)
      r =(Abs(maze(t) Mod 2) = 0)
      l =(Abs(maze(t - 1) Mod 2) = 0)
      d =(Abs(maze(t) Mod 10) < 2)
      dragonMoveCount = - 1
      u = 0
      If level = 0 And yPos = 1 Then 7005
7002  # top level safe at the top.
      u =(Abs(maze(t - 13) Mod 10) < 2)
7005  # chase the player, if move ok skip out
      xMove =(xPos > xBoss) * r -(xPos < xBoss) * l
      yMove =(yPos > yBoss) * d -(yPos < yBoss) * u
      i = Rnd(2)
      If xMove # 0 Or yMove # 0 Then 7018
      xMove = r - l
      yMove = d - u
      If countChange < 4 Then 7018
7015  # forced directional move.
      xMove = Sgn(xPos - xBoss)
      yMove = Sgn(yPos - yBoss)
7018  # pick only horiz or vertical where both available.
      If xMove # 0 And yMove # 0 Then xMove = xMove * i
      If xMove # 0 And yMove # 0 Then yMove = 0
      If 2 * xMove + 3 * yMove # - lastDragonMove Then countChange = - 1
      countChange = countChange + 1
      lastDragonMove = 2 * xMove + 3 * yMove
      u = xScreen
      r = yScreen
7020  # animate the move
      xScreen = xBossInfo
      yScreen = yBossInfo
      For i = 1 To 3
          Color= 0
          Gosub Drawsquare.10
          Color= colours(14)
          xScreen = xScreen + xMove
          yScreen = yScreen + yMove
          Gosub Drawsquare.10
      Next i
      xBossInfo = xScreen
      yBossInfo = yScreen
      xBoss = xBoss + xMove
      yBoss = yBoss + yMove
      xScreen = u
      yScreen = r
7030  # return if not at player else fall through into bumped into dragon.
      If xPos # xBoss Or yPos # yBoss Then Return
      Pop
8000  # ****************************************************************************************************
      #                                         Bumped into dragon
      # ****************************************************************************************************
      For i = 1 To 6
          Color= 1 +(i Mod 2) * 4
          Gosub Drawsquare.10
          For j = 1 To 8
              Poke 0,5
              Poke 24,2
              Call 2
      Next j,i
      bossStatus = 0
      xBoss = - 1
      yBoss = - 1
      a$ = "dragon"
      If magicSword Then 4750
8002  If partySize <= 2 Then Alldied.8325
      partySize = partySize - 2
      Call - 936
      Print "the dragon ate two of your party."
      Goto 3750
8300  # ****************************************************************************************************
      #                                        Display Colour Codes
      # ****************************************************************************************************
      dragonMoveCount = - 1
      Poke 50,63
      Call - 936
      Print " color codes for level ";level + 1;" are: ";
      Poke 50,255
8305  If level = 0 Then Print "l.green";
      If level = 1 Then Print "orange";
      If level = 2 Then Print "violet";
      If level = 3 Then Print "flesh";
      Print "=walls";
8307  Tab 16
      Print "l.blue=haz red=you yellow=treas. ";
      If level = 0 Or level = 1 Then Print "grey=dragon";
      If level = 2 Then Print "brown=snake";
8310  If level = 3 Then Print "grey=spect";
      Tab 29
      Print "white=stairsd.green=monst ";
      If level = 1 Or level = 2 Then Print "olive=gas";
      Goto Getcommand.1501
8325  # ****************************************************************************************************
      #                                     Party has been wiped out.
      # ****************************************************************************************************
      Text
      Call - 936
      Vtab 10
      Print "your expedition had no survivors. con- dolences will be sent to next of kin."
      End
